<!DOCTYPE html><html lang='pt'><head><meta charset='UTF-8'>
<title>Dashboard EasyGest 2026 - Interno</title>
<style>
body{margin:0;font-family:'Segoe UI',sans-serif;background:#0b204d;color:#fff;}
.layout{display:flex;min-height:100vh;}
.sidebar{width:230px;background:#081a3d;padding:24px 16px;box-shadow:2px 0 8px rgba(0,0,0,.4);display:flex;flex-direction:column;gap:24px;}
.menu-title{font-size:13px;text-transform:uppercase;letter-spacing:1px;color:#9ca3af;}
.nav{display:flex;flex-direction:column;gap:8px;}
.nav button{width:100%;border-radius:999px;border:1px solid transparent;padding:10px 14px;background:transparent;color:#e5e7eb;text-align:left;cursor:pointer;font-size:14px;display:flex;align-items:center;gap:10px;}
.nav button.active{background:#118bd4;border-color:#36a3e4;color:#ffffff;font-weight:600;}
.nav button:hover{background:rgba(148,163,184,.2);}
.nav img.nav-icon{width:18px;height:18px;display:block;}
.content{flex:1;padding:24px 32px 40px;}
.banner{display:flex;justify-content:center;padding:10px 0 20px 0;}
.banner img{max-height:150px;}
h1{margin:0 0 8px 0;font-size:26px;display:flex;align-items:center;gap:10px;}
.title-icon{width:22px;height:22px;display:inline-block;}
.subtitle{margin-bottom:24px;color:#cbd5f5;font-size:14px;}
.section-title{font-size:20px;margin:10px 0 20px;display:flex;align-items:center;gap:10px;}
.section-title img.section-icon{width:20px;height:20px;display:block;}
.pill{font-size:11px;text-transform:uppercase;letter-spacing:1px;padding:3px 8px;border-radius:999px;background:rgba(148,163,184,.2);}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:24px;}
.chart{background:#fff;border-radius:14px;box-shadow:0 2px 10px rgba(15,23,42,.5);padding:16px 18px 18px;overflow-x:auto;color:#111;}
.chart h2{text-align:center;margin-bottom:10px;font-size:16px;color:#0b204d;}
table{width:100%;border-collapse:collapse;font-size:13px;}
th,td{border:1px solid #e5e7eb;padding:6px 8px;text-align:left;}
th{background:#f9fafb;color:#111;}
.section{display:none;}
.section.active{display:block;}
.section-separator{margin:26px 0 12px;border-top:1px dashed rgba(148,163,184,.4);}
/* FIX ICONS SIDEBAR */
.nav button img, .nav-icon{
  width:18px;height:18px;display:inline-block;object-fit:contain;vertical-align:middle;flex:0 0 auto;
}

/* --- DireÃ§Ã£o subtabs + drilldown --- */
.pills{display:flex;gap:10px;flex-wrap:wrap;margin:6px 0 14px;}
.pillbtn{border:1px solid rgba(148,163,184,.35);background:rgba(148,163,184,.12);color:#e5e7eb;border-radius:999px;padding:6px 10px;font-size:12px;cursor:pointer;}
.pillbtn.active{background:#118bd4;border-color:#36a3e4;color:#fff;font-weight:600;}
.dir-pane{display:none;}
.dir-pane.active{display:block;}
.cards2{display:grid;grid-template-columns:1fr 1fr;gap:24px;}
.card{background:#fff;border-radius:14px;box-shadow:0 2px 10px rgba(15,23,42,.5);padding:14px 16px;color:#111;overflow-x:auto;}
.card-title{text-align:center;margin:2px 0 10px 0;font-size:14px;color:#0b204d;font-weight:700;}
a.drill{color:#0b204d;font-weight:700;text-decoration:underline;}
a.drill:hover{opacity:.85;}
.modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,.75);display:none;align-items:center;justify-content:center;z-index:9999;padding:18px;}
.modal{background:#fff;color:#0f172a;border-radius:16px;max-width:1100px;width:100%;max-height:85vh;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,.5);}
.modal-header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid #e5e7eb;gap:10px;}
.modal-title{font-weight:800;color:#0b204d;}
.modal-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
.modal-actions input{padding:8px 10px;border:1px solid #cbd5e1;border-radius:10px;min-width:240px;}
.btn{padding:8px 10px;border-radius:10px;border:1px solid #cbd5e1;background:#f8fafc;cursor:pointer;font-weight:600;}
.btn.primary{background:#118bd4;border-color:#36a3e4;color:#fff;}
.btn.danger{background:#ef4444;border-color:#ef4444;color:#fff;}
.modal-body{padding:12px 16px;overflow:auto;max-height:calc(85vh - 58px);}
.smallnote{font-size:12px;color:#64748b;margin-top:2px;}
.detail-table th{position:sticky;top:0;z-index:1;}

</style>
</head>
<body>
<script>
var p = prompt("ğŸ”’ Ãrea Reservada \n\nIntroduza a palavra-passe:");
if (p !== "direcao2026"){ alert("âŒ Acesso negado."); window.location.href="https://www.google.com/"; }
</script>
<div class='layout'>
<aside class='sidebar'>
<div class='menu-title'>Dashboards 2026 (Interno)</div>
<div class='nav'>
<button class='active' data-target='sec-ang'><img class='nav-icon' src='Angariacao.png' alt='AngariaÃ§Ãµes'>AngariaÃ§Ãµes</button>
<button data-target='sec-fat'><img class='nav-icon' src='Faturacao.png' alt='FaturaÃ§Ã£o'>FaturaÃ§Ã£o</button>
<button data-target='sec-dir'><img class='nav-icon' src='Dashboards.png' alt='DireÃ§Ã£o'>DireÃ§Ã£o</button>
</div>
</aside>
<main class='content'>
<div class='banner'><img src='banner_dashboard_final.jpg' alt='EasyGest'></div>
<h1><img class='title-icon' src='Dashboards.png' alt='Dashboards'>Dashboards EasyGest 2026</h1>
<div class='subtitle'>VisÃ£o consolidada de AngariaÃ§Ãµes e FaturaÃ§Ã£o.<br><span style='font-size:12px;opacity:.85'>Fonte FaturaÃ§Ã£o: <b>Resultados Ranking Faturacao 2026_.xlsx</b> | Fonte AngariaÃ§Ãµes: <b>angariacoes_2026_macro.xlsx</b></span></div>

<section id='sec-ang' class='section active'>
<div class='section-title'><img class='section-icon' src='Angariacao.png' alt='AngariaÃ§Ãµes'>Dashboard de AngariaÃ§Ãµes 2026 <span class='pill'>MediaÃ§Ã£o</span></div>
<div class='grid'>

<div class='chart'><h2>Angariador - Total</h2>
<table><thead><tr><th>Lugar</th><th>Angariador</th><th>Total</th></tr></thead><tbody>
<tr><td>ğŸ¥‡ 1Âº</td><td>JosÃ© Estebainha</td><td>4</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Ana Cruz</td><td>3</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Madalena Melo</td><td>3</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Paula Coelho</td><td>3</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Agostinho Gomes</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Paulo Julio</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>MÃ¡rio Ã‚ngelo</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Lurdes Macedo</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Luisa Fernandes</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Elisabete Laurindo</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>JoÃ£o V GonÃ§alves</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Carlos Estebainha</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Paulo M Santos</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>LuÃ­sa Salgado</td><td>2</td></tr><tr><td>4Âº</td><td>Manuel Nunes</td><td>1</td></tr><tr><td>4Âº</td><td>Bruno Rodrigues</td><td>1</td></tr><tr><td>4Âº</td><td>SÃ³nia Santos</td><td>1</td></tr><tr><td>4Âº</td><td>Tiago Abreu Pereira</td><td>1</td></tr><tr><td>4Âº</td><td>Carlos Marco</td><td>1</td></tr><tr><td>4Âº</td><td>Olinda Silva</td><td>1</td></tr><tr><td>4Âº</td><td>Cristina MendonÃ§a</td><td>1</td></tr><tr><td>4Âº</td><td>Miguel Rodrigues</td><td>1</td></tr><tr><td>4Âº</td><td>Miguel Ã‚ngelo</td><td>1</td></tr><tr><td>4Âº</td><td>Manuela ConceiÃ§Ã£o</td><td>1</td></tr><tr><td>4Âº</td><td>Nicole Nunes</td><td>1</td></tr><tr><td>4Âº</td><td>GraÃ§a Corvinho</td><td>1</td></tr><tr><td>4Âº</td><td>Diana Marques</td><td>1</td></tr><tr><td>4Âº</td><td>Paula Rodrigues</td><td>1</td></tr><tr><td>4Âº</td><td>Carina Salgueiro</td><td>1</td></tr><tr><td>4Âº</td><td>Carlos Mendes</td><td>1</td></tr><tr><td>4Âº</td><td>Jose Antunes</td><td>1</td></tr><tr><td>4Âº</td><td>JosÃ© Rodrigues</td><td>1</td></tr><tr><td>4Âº</td><td>Ãlvaro Ferreira</td><td>1</td></tr><tr><td>4Âº</td><td>Carlos Abrantes</td><td>1</td></tr><tr><td>4Âº</td><td>Antonieta Martins</td><td>1</td></tr><tr><td>4Âº</td><td>Luis Maciel</td><td>1</td></tr><tr><td>4Âº</td><td>Vera Santos Silva</td><td>1</td></tr><tr><td>4Âº</td><td>Anabela LourenÃ§o</td><td>1</td></tr><tr><td>4Âº</td><td>Adriana Assis</td><td>1</td></tr><tr><td>4Âº</td><td>Francisco Fernandes</td><td>1</td></tr><tr><td>4Âº</td><td>SÃ³nia Pisco</td><td>1</td></tr><tr><td>4Âº</td><td>PatrÃ­cia FÃ©lix</td><td>1</td></tr><tr><td>4Âº</td><td>Liliana Duarte</td><td>1</td></tr>
</tbody></table></div>


<div class='chart'><h2>Loja - Total</h2>
<table><thead><tr><th>Lugar</th><th>Loja</th><th>Total</th></tr></thead><tbody>
<tr><td>ğŸ¥‡ 1Âº</td><td>Coimbra</td><td>10</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Oeiras</td><td>7</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>PortimÃ£o</td><td>6</td></tr><tr><td>4Âº</td><td>Vila Real de Sto AntÃ³nio</td><td>5</td></tr><tr><td>5Âº</td><td>Beja</td><td>4</td></tr><tr><td>5Âº</td><td>Aveiro</td><td>4</td></tr><tr><td>5Âº</td><td>Aljustrel</td><td>4</td></tr><tr><td>5Âº</td><td>GraÃ§a</td><td>4</td></tr><tr><td>6Âº</td><td>NazarÃ©</td><td>3</td></tr><tr><td>6Âº</td><td>Pinhal Novo</td><td>3</td></tr><tr><td>7Âº</td><td>Tavira</td><td>2</td></tr><tr><td>7Âº</td><td>AÃ§ores</td><td>2</td></tr><tr><td>7Âº</td><td>LourinhÃ£</td><td>2</td></tr><tr><td>8Âº</td><td>Laranjeiras</td><td>1</td></tr><tr><td>8Âº</td><td>Setubal</td><td>1</td></tr><tr><td>8Âº</td><td>Mem Martins</td><td>1</td></tr><tr><td>8Âº</td><td>EasyHub Seixal</td><td>1</td></tr><tr><td>8Âº</td><td>Leiria</td><td>1</td></tr><tr><td>8Âº</td><td>BraganÃ§a</td><td>1</td></tr>
</tbody></table></div>


<div class='chart'><h2>Angariador - Exclusivo</h2>
<table><thead><tr><th>Lugar</th><th>Angariador</th><th>Exclusivos</th></tr></thead><tbody>
<tr><td>ğŸ¥‡ 1Âº</td><td>Ana Cruz</td><td>3</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Elisabete Laurindo</td><td>2</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Lurdes Macedo</td><td>2</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Carlos Estebainha</td><td>2</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Bruno Rodrigues</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Manuel Nunes</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Luisa Fernandes</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Paulo Julio</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Tiago Abreu Pereira</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Olinda Silva</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Diana Marques</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Paulo M Santos</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Miguel Ã‚ngelo</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Manuela ConceiÃ§Ã£o</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Nicole Nunes</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Antonieta Martins</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Miguel Rodrigues</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>JosÃ© Rodrigues</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Paula Coelho</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Luis Maciel</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Adriana Assis</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Francisco Fernandes</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>SÃ³nia Pisco</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>PatrÃ­cia FÃ©lix</td><td>1</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Liliana Duarte</td><td>1</td></tr>
</tbody></table></div>


<div class='chart'><h2>Loja - Exclusivo</h2>
<table><thead><tr><th>Lugar</th><th>Loja</th><th>Exclusivos</th></tr></thead><tbody>
<tr><td>ğŸ¥‡ 1Âº</td><td>Coimbra</td><td>5</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Beja</td><td>4</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>PortimÃ£o</td><td>4</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>GraÃ§a</td><td>3</td></tr><tr><td>4Âº</td><td>Pinhal Novo</td><td>2</td></tr><tr><td>4Âº</td><td>Vila Real de Sto AntÃ³nio</td><td>2</td></tr><tr><td>4Âº</td><td>AÃ§ores</td><td>2</td></tr><tr><td>4Âº</td><td>Oeiras</td><td>2</td></tr><tr><td>5Âº</td><td>Laranjeiras</td><td>1</td></tr><tr><td>5Âº</td><td>Setubal</td><td>1</td></tr><tr><td>5Âº</td><td>Aveiro</td><td>1</td></tr><tr><td>5Âº</td><td>Mem Martins</td><td>1</td></tr><tr><td>5Âº</td><td>LourinhÃ£</td><td>1</td></tr><tr><td>5Âº</td><td>BraganÃ§a</td><td>1</td></tr>
</tbody></table></div>

</div>
<div class='section-separator'></div>
</section>

<section id='sec-fat' class='section'>
<div class='section-title'><img class='section-icon' src='Faturacao.png' alt='FaturaÃ§Ã£o'>Dashboard de FaturaÃ§Ã£o 2026 <span class='pill'>ComissÃ£o LÃ­quida</span></div>
<div class='grid'>

<div class='chart'><h2>Consultores - ComissÃ£o LÃ­quida</h2>
<table><thead><tr><th>Lugar</th><th>Consultor</th><th>ComissÃ£o LÃ­quida</th></tr></thead><tbody>
<tr><td>ğŸ¥‡ 1Âº</td><td>Paulo Julio</td><td>11.859,38 â‚¬</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>GraÃ§a Corvinho</td><td>10.582,50 â‚¬</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Madalena Melo</td><td>10.313,00 â‚¬</td></tr><tr><td>4Âº</td><td>Joaquim Belim</td><td>7.250,00 â‚¬</td></tr><tr><td>5Âº</td><td>Elisabete Laurindo</td><td>6.475,00 â‚¬</td></tr><tr><td>6Âº</td><td>Fernando Rocha</td><td>6.146,97 â‚¬</td></tr><tr><td>7Âº</td><td>LuÃ­sa Salgado</td><td>6.000,00 â‚¬</td></tr><tr><td>8Âº</td><td>Tiago Abreu Pereira</td><td>5.500,00 â‚¬</td></tr><tr><td>9Âº</td><td>Lurdes Macedo</td><td>5.200,00 â‚¬</td></tr><tr><td>10Âº</td><td>AndrÃ© Boavida</td><td>5.000,00 â‚¬</td></tr>
</tbody></table></div>


<div class='chart'><h2>Lojas - ComissÃ£o LÃ­quida</h2>
<table><thead><tr><th>Lugar</th><th>Loja</th><th>ComissÃ£o LÃ­quida</th></tr></thead><tbody>
<tr><td>ğŸ¥‡ 1Âº</td><td>Coimbra</td><td>26.984,38 â‚¬</td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Vila Real de Sto Antonio</td><td>14.937,50 â‚¬</td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>SetÃºbal</td><td>12.637,50 â‚¬</td></tr><tr><td>4Âº</td><td>Aveiro</td><td>10.313,00 â‚¬</td></tr><tr><td>5Âº</td><td>GraÃ§a</td><td>10.200,00 â‚¬</td></tr><tr><td>6Âº</td><td>Pinhal Novo</td><td>9.260,00 â‚¬</td></tr><tr><td>7Âº</td><td>AÃ§ores</td><td>8.646,97 â‚¬</td></tr><tr><td>8Âº</td><td>NazarÃ©</td><td>8.250,00 â‚¬</td></tr><tr><td>9Âº</td><td>Vila Real de Santo AntÃ³nio</td><td>4.240,00 â‚¬</td></tr><tr><td>10Âº</td><td>EasyHub Seixal</td><td>3.967,50 â‚¬</td></tr>
</tbody></table></div>

</div>
</section>



<section id='sec-dir' class='section'>
  <div class='section-title'><img class='section-icon' src='Dashboards.png' alt='DireÃ§Ã£o'>DireÃ§Ã£o 2026 <span class='pill'>GestÃ£o</span></div>
  <div class="pills"><button class='pillbtn active' data-dir='__AGENCIA__'>AgÃªncia</button>
<button class='pillbtn' data-dir='Bruno Rodrigues'>Bruno Rodrigues (10.200,00 â‚¬)</button>
<button class='pillbtn' data-dir='Carlos Mendes'>Carlos Mendes (49.325,00 â‚¬)</button>
<button class='pillbtn' data-dir='Joana Marques'>Joana Marques (37.297,38 â‚¬)</button>
<button class='pillbtn' data-dir='Nuno Marques'>Nuno Marques (15.546,97 â‚¬)</button>
<button class='pillbtn' data-dir='JP'>JP (3.440,00 â‚¬)</button></div>
  
<div class="dir-pane active" data-pane="__AGENCIA__">
  <div class="cards2">
    <div class="card"><div class="card-title">Total (Diretor)</div><table><thead><tr><th>Diretor</th><th>Total</th></tr></thead><tbody><tr><td>Carlos Mendes</td><td><a href='#' class='drill' data-filter-type='director' data-director='Carlos Mendes'>49.325,00 â‚¬</a></td></tr><tr><td>Joana Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Joana Marques'>37.297,38 â‚¬</a></td></tr><tr><td>Nuno Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Nuno Marques'>15.546,97 â‚¬</a></td></tr><tr><td>Bruno Rodrigues</td><td><a href='#' class='drill' data-filter-type='director' data-director='Bruno Rodrigues'>10.200,00 â‚¬</a></td></tr><tr><td>JP</td><td><a href='#' class='drill' data-filter-type='director' data-director='JP'>3.440,00 â‚¬</a></td></tr></tbody></table></div>
    <div class="card"><div class="card-title">Total por Loja</div><table class='store-table'><thead><tr><th>Loja</th><th>Total</th></tr></thead><tbody><tr><td>Coimbra</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='Coimbra'>26.984,38 â‚¬</a></td></tr><tr><td>Vila Real de Santo AntÃ³nio</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='Vila Real de Santo AntÃ³nio'>19.177,50 â‚¬</a></td></tr><tr><td>SetÃºbal</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='SetÃºbal'>12.637,50 â‚¬</a></td></tr><tr><td>Aveiro</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='Aveiro'>10.313,00 â‚¬</a></td></tr><tr><td>GraÃ§a Lx</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='GraÃ§a Lx'>10.200,00 â‚¬</a></td></tr><tr><td>Pinhal Novo</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='Pinhal Novo'>9.260,00 â‚¬</a></td></tr><tr><td>AÃ§ores</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='AÃ§ores'>8.646,97 â‚¬</a></td></tr><tr><td>NazarÃ©</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='NazarÃ©'>8.250,00 â‚¬</a></td></tr><tr><td>Oeiras</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='Oeiras'>3.900,00 â‚¬</a></td></tr><tr><td>Beja</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='Beja'>3.440,00 â‚¬</a></td></tr><tr><td>BraganÃ§a</td><td><a href='#' class='drill' data-filter-type='store' data-director='__AGENCIA__' data-store='BraganÃ§a'>3.000,00 â‚¬</a></td></tr></tbody></table></div>
  </div>
  <div class="section-separator"></div>
  <div class="grid">
<div class='chart'><h2>AgÃªncia - Valor</h2>
<table><thead><tr><th>Indicador</th><th>Valor</th></tr></thead>
<tbody><tr><td>AgÃªncia</td><td><a href='#' class='drill' data-filter-type='agency'>9.026,93 â‚¬</a></td></tr></tbody></table></div>

<div class='chart'><h2>Chefes - ComissÃ£o (DireÃ§Ã£o)</h2>
<table><thead><tr><th>Lugar</th><th>Chefe</th><th>Valor</th></tr></thead>
<tbody><tr><td>ğŸ¥‡ 1Âº</td><td>Carlos Mendes</td><td><a href='#' class='drill' data-filter-type='director' data-director='Carlos Mendes'>22.134,27 â‚¬</a></td></tr><tr><td>ğŸ¥ˆ 2Âº</td><td>Joana Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Joana Marques'>8.150,14 â‚¬</a></td></tr><tr><td>ğŸ¥‰ 3Âº</td><td>Nuno Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Nuno Marques'>2.275,72 â‚¬</a></td></tr><tr><td>4Âº</td><td>JP</td><td><a href='#' class='drill' data-filter-type='director' data-director='JP'>1.146,66 â‚¬</a></td></tr><tr><td>5Âº</td><td>Bruno Rodrigues</td><td><a href='#' class='drill' data-filter-type='director' data-director='Bruno Rodrigues'>1.040,00 â‚¬</a></td></tr></tbody></table></div>
</div>
</div>

<div class="dir-pane" data-pane="Bruno Rodrigues">
  <div class="cards2">
    <div class="card"><div class="card-title">Total (Diretor)</div><table><thead><tr><th>Diretor</th><th>Total</th></tr></thead><tbody><tr><td>Bruno Rodrigues</td><td><a href='#' class='drill' data-filter-type='director' data-director='Bruno Rodrigues'>10.200,00 â‚¬</a></td></tr></tbody></table></div>
    <div class="card"><div class="card-title">Total por Loja</div><table class='store-table'><thead><tr><th>Loja</th><th>Total</th></tr></thead><tbody><tr><td>GraÃ§a Lx</td><td><a href='#' class='drill' data-filter-type='store' data-director='Bruno Rodrigues' data-store='GraÃ§a Lx'>10.200,00 â‚¬</a></td></tr></tbody></table></div>
  </div>
  <div class="section-separator"></div>
  <div class="cards2">
    <div class="card"><div class="card-title">ComissÃ£o a Receber (DireÃ§Ã£o)</div>
      <table><thead><tr><th>Diretor</th><th>Total</th></tr></thead>
      <tbody><tr><td>Bruno Rodrigues</td><td><a href='#' class='drill' data-filter-type='director' data-director='Bruno Rodrigues'>1.040,00 â‚¬</a></td></tr></tbody></table>
    </div>
  </div>

</div>

<div class="dir-pane" data-pane="Carlos Mendes">
  <div class="cards2">
    <div class="card"><div class="card-title">Total (Diretor)</div><table><thead><tr><th>Diretor</th><th>Total</th></tr></thead><tbody><tr><td>Carlos Mendes</td><td><a href='#' class='drill' data-filter-type='director' data-director='Carlos Mendes'>49.325,00 â‚¬</a></td></tr></tbody></table></div>
    <div class="card"><div class="card-title">Total por Loja</div><table class='store-table'><thead><tr><th>Loja</th><th>Total</th></tr></thead><tbody><tr><td>Vila Real de Santo AntÃ³nio</td><td><a href='#' class='drill' data-filter-type='store' data-director='Carlos Mendes' data-store='Vila Real de Santo AntÃ³nio'>19.177,50 â‚¬</a></td></tr><tr><td>SetÃºbal</td><td><a href='#' class='drill' data-filter-type='store' data-director='Carlos Mendes' data-store='SetÃºbal'>12.637,50 â‚¬</a></td></tr><tr><td>Pinhal Novo</td><td><a href='#' class='drill' data-filter-type='store' data-director='Carlos Mendes' data-store='Pinhal Novo'>9.260,00 â‚¬</a></td></tr><tr><td>NazarÃ©</td><td><a href='#' class='drill' data-filter-type='store' data-director='Carlos Mendes' data-store='NazarÃ©'>8.250,00 â‚¬</a></td></tr></tbody></table></div>
  </div>
  <div class="section-separator"></div>
  <div class="cards2">
    <div class="card"><div class="card-title">ComissÃ£o a Receber (DireÃ§Ã£o)</div>
      <table><thead><tr><th>Diretor</th><th>Total</th></tr></thead>
      <tbody><tr><td>Carlos Mendes</td><td><a href='#' class='drill' data-filter-type='director' data-director='Carlos Mendes'>22.134,27 â‚¬</a></td></tr></tbody></table>
    </div>
  </div>

</div>

<div class="dir-pane" data-pane="Joana Marques">
  <div class="cards2">
    <div class="card"><div class="card-title">Total (Diretor)</div><table><thead><tr><th>Diretor</th><th>Total</th></tr></thead><tbody><tr><td>Joana Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Joana Marques'>37.297,38 â‚¬</a></td></tr></tbody></table></div>
    <div class="card"><div class="card-title">Total por Loja</div><table class='store-table'><thead><tr><th>Loja</th><th>Total</th></tr></thead><tbody><tr><td>Coimbra</td><td><a href='#' class='drill' data-filter-type='store' data-director='Joana Marques' data-store='Coimbra'>26.984,38 â‚¬</a></td></tr><tr><td>Aveiro</td><td><a href='#' class='drill' data-filter-type='store' data-director='Joana Marques' data-store='Aveiro'>10.313,00 â‚¬</a></td></tr></tbody></table></div>
  </div>
  <div class="section-separator"></div>
  <div class="cards2">
    <div class="card"><div class="card-title">ComissÃ£o a Receber (DireÃ§Ã£o)</div>
      <table><thead><tr><th>Diretor</th><th>Total</th></tr></thead>
      <tbody><tr><td>Joana Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Joana Marques'>8.150,14 â‚¬</a></td></tr></tbody></table>
    </div>
  </div>

</div>

<div class="dir-pane" data-pane="Nuno Marques">
  <div class="cards2">
    <div class="card"><div class="card-title">Total (Diretor)</div><table><thead><tr><th>Diretor</th><th>Total</th></tr></thead><tbody><tr><td>Nuno Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Nuno Marques'>15.546,97 â‚¬</a></td></tr></tbody></table></div>
    <div class="card"><div class="card-title">Total por Loja</div><table class='store-table'><thead><tr><th>Loja</th><th>Total</th></tr></thead><tbody><tr><td>AÃ§ores</td><td><a href='#' class='drill' data-filter-type='store' data-director='Nuno Marques' data-store='AÃ§ores'>8.646,97 â‚¬</a></td></tr><tr><td>Oeiras</td><td><a href='#' class='drill' data-filter-type='store' data-director='Nuno Marques' data-store='Oeiras'>3.900,00 â‚¬</a></td></tr><tr><td>BraganÃ§a</td><td><a href='#' class='drill' data-filter-type='store' data-director='Nuno Marques' data-store='BraganÃ§a'>3.000,00 â‚¬</a></td></tr></tbody></table></div>
  </div>
  <div class="section-separator"></div>
  <div class="cards2">
    <div class="card"><div class="card-title">ComissÃ£o a Receber (DireÃ§Ã£o)</div>
      <table><thead><tr><th>Diretor</th><th>Total</th></tr></thead>
      <tbody><tr><td>Nuno Marques</td><td><a href='#' class='drill' data-filter-type='director' data-director='Nuno Marques'>2.275,72 â‚¬</a></td></tr></tbody></table>
    </div>
  </div>

</div>

<div class="dir-pane" data-pane="JP">
  <div class="cards2">
    <div class="card"><div class="card-title">Total (Diretor)</div><table><thead><tr><th>Diretor</th><th>Total</th></tr></thead><tbody><tr><td>JP</td><td><a href='#' class='drill' data-filter-type='director' data-director='JP'>3.440,00 â‚¬</a></td></tr></tbody></table></div>
    <div class="card"><div class="card-title">Total por Loja</div><table class='store-table'><thead><tr><th>Loja</th><th>Total</th></tr></thead><tbody><tr><td>Beja</td><td><a href='#' class='drill' data-filter-type='store' data-director='JP' data-store='Beja'>3.440,00 â‚¬</a></td></tr></tbody></table></div>
  </div>
  <div class="section-separator"></div>
  <div class="cards2">
    <div class="card"><div class="card-title">ComissÃ£o a Receber (DireÃ§Ã£o)</div>
      <table><thead><tr><th>Diretor</th><th>Total</th></tr></thead>
      <tbody><tr><td>JP</td><td><a href='#' class='drill' data-filter-type='director' data-director='JP'>1.146,66 â‚¬</a></td></tr></tbody></table>
    </div>
  </div>

</div>

</section>


</main></div>
<script>
const b = document.querySelectorAll('.nav button'), s = document.querySelectorAll('.section');
b.forEach(x => x.onclick = () => {
  b.forEach(i => i.classList.remove('active'));
  x.classList.add('active');
  s.forEach(j => j.classList.toggle('active', j.id === x.dataset.target));
});
</script>

<!-- Drilldown Modal -->
<div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="modal-header">
      <div>
        <div class="modal-title" id="modalTitle">Detalhe</div>
        <div class="smallnote" id="modalSubtitle"></div>
      </div>
      <div class="modal-actions">
        <input id="searchBox" placeholder="Pesquisar (referÃªncia, cliente, imÃ³vel, etc.)">
        <button class="btn primary" id="exportCsvBtn">Exportar CSV</button>
        <button class="btn danger" id="closeModalBtn">Fechar</button>
      </div>
    </div>
    <div class="modal-body">
      <div id="detailCount" class="smallnote" style="margin-bottom:10px;"></div>
      <div style="overflow:auto;">
        <table class="detail-table" id="detailTable"></table>
      </div>
    </div>
  </div>
</div>

<script>
// DireÃ§Ã£o pills
(function(){
  const pillBtns = document.querySelectorAll('.pillbtn');
  const panes = document.querySelectorAll('.dir-pane');
  pillBtns.forEach(pb => pb.addEventListener('click', () => {
    pillBtns.forEach(x => x.classList.remove('active'));
    pb.classList.add('active');
    const key = pb.dataset.dir;
    panes.forEach(p => p.classList.toggle('active', p.dataset.pane === key));
  }));
})();

// Drilldown data (Resultados Gerais embebido)
const detailData = [{"Documento": "", "VEN_": 1094231, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Vila Real de Sto Antonio", "Valor ComissÃ£o LÃ­q.": 3150.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "GraÃ§a Corvinho", "Valor Recebido": 1260, "GestÃ£o": "Carlos Mendes", "Equipa": "Vila Real de Santo AntÃ³nio", "Loja.1": "Vila Real de Santo AntÃ³nio"}, {"Documento": "", "VEN_": 1078530, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "AÃ§ores", "Valor ComissÃ£o LÃ­q.": 2119.32, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Fernando Rocha", "Valor Recebido": 1271.59, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Fernando Rocha", "Loja.1": "AÃ§ores"}, {"Documento": "", "VEN_": 1098414, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "GraÃ§a", "Valor ComissÃ£o LÃ­q.": 5000.0, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "AndrÃ© Boavida", "Valor Recebido": 2000, "GestÃ£o": "Bruno Rodrigues", "Equipa": "GraÃ§a Lx", "Loja.1": "GraÃ§a Lx"}, {"Documento": "", "VEN_": 1095595, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "SetÃºbal", "Valor ComissÃ£o LÃ­q.": 5500.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Tiago Abreu Pereira", "Valor Recebido": "2Â 750â‚¬", "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Ana Cristina", "Loja.1": "SetÃºbal"}, {"Documento": "", "VEN_": 1089015, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Oeiras", "Valor ComissÃ£o LÃ­q.": 800.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Mario Angelo", "Valor Recebido": 320, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Mario Angelo", "Loja.1": "Oeiras"}, {"Documento": "", "VEN_": "1089015_1", "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Oeiras", "Valor ComissÃ£o LÃ­q.": 400.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Patricia Felix", "Valor Recebido": 200, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Mario Angelo", "Loja.1": "Oeiras"}, {"Documento": "", "VEN_": "1089015_1", "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Oeiras", "Valor ComissÃ£o LÃ­q.": 400.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Mario Angelo", "Valor Recebido": 160, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Mario Angelo", "Loja.1": "Oeiras"}, {"Documento": "", "VEN_": 1097157, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Coimbra", "Valor ComissÃ£o LÃ­q.": 7425.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Paulo Julio", "Valor Recebido": 3712.5, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Coimbra", "Loja.1": "Coimbra"}, {"Documento": "", "VEN_": 1099733, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Vila Real de Sto Antonio", "Valor ComissÃ£o LÃ­q.": 1100.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Elisabete Laurindo", "Valor Recebido": 550, "GestÃ£o": "Carlos Mendes", "Equipa": "Vila Real de Santo AntÃ³nio", "Loja.1": "Vila Real de Santo AntÃ³nio"}, {"Documento": "", "VEN_": 1026887, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "AÃ§ores", "Valor ComissÃ£o LÃ­q.": 4027.65, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Fernando Rocha", "Valor Recebido": 2416.6, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Fernando Rocha", "Loja.1": "AÃ§ores"}, {"Documento": "", "VEN_": 1064029, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Beja", "Valor ComissÃ£o LÃ­q.": 3440.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Carlos Estebainha", "Valor Recebido": 1376, "GestÃ£o": "JP", "Equipa": "Beja", "Loja.1": "Beja"}, {"Documento": "", "VEN_": 1099166, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Coimbra", "Valor ComissÃ£o LÃ­q.": 4434.38, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Paulo Julio", "Valor Recebido": 2217.18, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Coimbra", "Loja.1": "Coimbra"}, {"Documento": "", "VEN_": 1088206, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "NazarÃ©", "Valor ComissÃ£o LÃ­q.": 7250.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Joaquim Belim", "Valor Recebido": 3289.33, "GestÃ£o": "Carlos Mendes", "Equipa": "NazarÃ©", "Loja.1": "NazarÃ©"}, {"Documento": "", "VEN_": 1088216, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "EasyHub Seixal", "Valor ComissÃ£o LÃ­q.": 3967.5, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "Roberto Da Silva	", "Valor Recebido": 2380.5, "GestÃ£o": "JoÃ£o Costa", "Equipa": "Equipa Ruben Ferreira", "Loja.1": "EasyHub Seixal"}, {"Documento": "", "VEN_": 1099725, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "SetÃºbal", "Valor ComissÃ£o LÃ­q.": 1625.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Luis Cruz", "Valor Recebido": 812.5, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Ana Cristina", "Loja.1": "SetÃºbal"}, {"Documento": "", "VEN_": 1091584, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Aveiro", "Valor ComissÃ£o LÃ­q.": 5137.5, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Madalena Melo", "Valor Recebido": 2055, "GestÃ£o": "Joana Marques", "Equipa": "Aveiro", "Loja.1": "Aveiro"}, {"Documento": "", "VEN_": 1091417, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "BraganÃ§a", "Valor ComissÃ£o LÃ­q.": 3000.0, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "SÃ³nia Pisco", "Valor Recebido": 1500, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Mogadouro", "Loja.1": "BraganÃ§a"}, {"Documento": "", "VEN_": 1098879, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "SetÃºbal", "Valor ComissÃ£o LÃ­q.": 3062.5, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Luis Cruz", "Valor Recebido": 1531.25, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Ana Cristina", "Loja.1": "SetÃºbal"}, {"Documento": "", "VEN_": 1093931, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Aveiro", "Valor ComissÃ£o LÃ­q.": 5175.5, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Madalena Melo", "Valor Recebido": 2070.2, "GestÃ£o": "Joana Marques", "Equipa": "Aveiro", "Loja.1": "Aveiro"}, {"Documento": "", "VEN_": 1088257, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Coimbra", "Valor ComissÃ£o LÃ­q.": 5000.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Paulo M Santos", "Valor Recebido": 2500, "GestÃ£o": "Joana Marques", "Equipa": "Equipa Viseu", "Loja.1": "Coimbra"}, {"Documento": "", "VEN_": 1092810, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Vila Real de Sto Antonio", "Valor ComissÃ£o LÃ­q.": 5312.5, "Normal": "Sim", "Estado": "Fechado", "Comercial": "GraÃ§a Corvinho", "Valor Recebido": 2125, "GestÃ£o": "Carlos Mendes", "Equipa": "Vila Real de Santo AntÃ³nio", "Loja.1": "Vila Real de Santo AntÃ³nio"}, {"Documento": "", "VEN_": 1100296, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Vila Real de Sto Antonio", "Valor ComissÃ£o LÃ­q.": 5375.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Elisabete Laurindo", "Valor Recebido": 2687.5, "GestÃ£o": "Carlos Mendes", "Equipa": "Vila Real de Santo AntÃ³nio", "Loja.1": "Vila Real de Santo AntÃ³nio"}, {"Documento": "", "VEN_": 1097288, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Coimbra", "Valor ComissÃ£o LÃ­q.": 6000.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "LuÃ­sa Salgado", "Valor Recebido": 2400, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Coimbra", "Loja.1": "Coimbra"}, {"Documento": "", "VEN_": 1100502, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Oeiras", "Valor ComissÃ£o LÃ­q.": 2300.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Matos Pires", "Valor Recebido": 1380, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa EasyWay", "Loja.1": "Oeiras"}, {"Documento": "", "VEN_": 1088753, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "GraÃ§a", "Valor ComissÃ£o LÃ­q.": 5200.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Lurdes Macedo", "Valor Recebido": 2600, "GestÃ£o": "Bruno Rodrigues", "Equipa": "GraÃ§a Lx", "Loja.1": "GraÃ§a Lx"}, {"Documento": "", "VEN_": 1087689, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "SetÃºbal", "Valor ComissÃ£o LÃ­q.": 1200.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Adelaide Alpande", "Valor Recebido": 600, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Charneca da Caparica", "Loja.1": "SetÃºbal"}, {"Documento": "", "VEN_": 1096217, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "AÃ§ores", "Valor ComissÃ£o LÃ­q.": 2500.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Manuel Silva", "Valor Recebido": 1500, "GestÃ£o": "Nuno Marques", "Equipa": "Equipa Manuel Silva", "Loja.1": "AÃ§ores"}, {"Documento": "", "VEN_": 1086495, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Pinhal Novo ", "Valor ComissÃ£o LÃ­q.": 4630.0, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "Luisa Fernandes", "Valor Recebido": 2315, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Sombras", "Loja.1": "Pinhal Novo "}, {"Documento": "", "VEN_": 1086495, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Pinhal Novo ", "Valor ComissÃ£o LÃ­q.": 4630.0, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "Yuri Costinha", "Valor Recebido": 2315, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Sombras", "Loja.1": "Pinhal Novo "}, {"Documento": "", "VEN_": 1092598, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Vila Real de Santo AntÃ³nio", "Valor ComissÃ£o LÃ­q.": 2120.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "GraÃ§a Corvinho", "Valor Recebido": 848, "GestÃ£o": "Carlos Mendes", "Equipa": "Vila Real de Santo AntÃ³nio", "Loja.1": "Vila Real de Santo AntÃ³nio"}, {"Documento": "", "VEN_": 1092598, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Vila Real de Santo AntÃ³nio", "Valor ComissÃ£o LÃ­q.": 2120.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Ã‚ngela Oeiras", "Valor Recebido": 848, "GestÃ£o": "Carlos Mendes", "Equipa": "Vila Real de Santo AntÃ³nio", "Loja.1": "Vila Real de Santo AntÃ³nio"}, {"Documento": "", "VEN_": 1091116, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "SetÃºbal", "Valor ComissÃ£o LÃ­q.": 1250.0, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "Adelaide Alpande", "Valor Recebido": 625, "GestÃ£o": "Carlos Mendes", "Equipa": "Equipa Charneca da Caparica", "Loja.1": "SetÃºbal"}, {"Documento": "", "VEN_": 1033627, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "NazarÃ©", "Valor ComissÃ£o LÃ­q.": 1000.0, "Normal": "NÃ£o", "Estado": "Fechado", "Comercial": "Carlos Abrantes", "Valor Recebido": 450, "GestÃ£o": "Carlos Mendes", "Equipa": "NazarÃ©", "Loja.1": "NazarÃ©"}, {"Documento": "", "VEN_": 1089092, "Ano Neg.": 2026, "MÃªs Neg.": 1, "Loja": "Coimbra", "Valor ComissÃ£o LÃ­q.": 4125.0, "Normal": "Sim", "Estado": "Fechado", "Comercial": "Bruno Marques", "Valor Recebido": 2062.5, "GestÃ£o": "Joana Marques", "Equipa": "Equipa Coimbra", "Loja.1": "Coimbra"}];

// Modal helpers
const backdrop = document.getElementById('modalBackdrop');
const closeBtn = document.getElementById('closeModalBtn');
const exportBtn = document.getElementById('exportCsvBtn');
const searchBox = document.getElementById('searchBox');
const titleEl = document.getElementById('modalTitle');
const subEl = document.getElementById('modalSubtitle');
const tableEl = document.getElementById('detailTable');
const countEl = document.getElementById('detailCount');
let currentRows = [];

function openModal(title, subtitle, rows) {
  titleEl.textContent = title;
  subEl.textContent = subtitle || '';
  searchBox.value = '';
  currentRows = rows.slice();
  renderTable(currentRows);
  backdrop.style.display = 'flex';
  searchBox.focus();
}
function closeModal() {
  backdrop.style.display = 'none';
  tableEl.innerHTML = '';
  currentRows = [];
}
closeBtn.addEventListener('click', closeModal);
backdrop.addEventListener('click', (e) => { if (e.target === backdrop) closeModal(); });
document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && backdrop.style.display === 'flex') closeModal(); });

function renderTable(rows) {
  if (!rows || rows.length === 0) {
    tableEl.innerHTML = "<thead><tr><th>Sem resultados</th></tr></thead><tbody><tr><td style='padding:12px;color:#64748b;'>NÃ£o existem linhas para este filtro.</td></tr></tbody>";
    countEl.textContent = "0 linhas";
    return;
  }
  const cols = Object.keys(rows[0]);
  const thead = "<thead><tr>" + cols.map(c => `<th>${c}</th>`).join('') + "</tr></thead>";
  const tbody = "<tbody>" + rows.map(r => "<tr>" + cols.map(c => `<td>${String(r[c] ?? '')}</td>`).join('') + "</tr>").join('') + "</tbody>";
  tableEl.innerHTML = thead + tbody;
  countEl.textContent = `${rows.length} linhas`;
}
function filterRows(baseRows, q) {
  if (!q) return baseRows;
  const qq = q.toLowerCase().trim();
  return baseRows.filter(r => Object.values(r).some(v => String(v ?? '').toLowerCase().includes(qq)));
}
searchBox.addEventListener('input', () => {
  renderTable(filterRows(currentRows, searchBox.value));
});
function toCsv(rows) {
  if (!rows || rows.length === 0) return "";
  const cols = Object.keys(rows[0]);
  const esc = (s) => '"' + String(s ?? "").replace(/"/g, '""') + '"';
  const lines = [];
  lines.push(cols.map(esc).join(","));
  rows.forEach(r => {
    lines.push(cols.map(c => esc(r[c])).join(","));
  });
  return lines.join("\n");
}
exportBtn.addEventListener('click', () => {
  const rows = filterRows(currentRows, searchBox.value);
  const csv = toCsv(rows);
  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const ts = new Date().toISOString().slice(0,19).replace(/[:T]/g,'-');
  a.href = url;
  a.download = `detalhe_direcao_${ts}.csv`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
});

// Drill click handling
document.querySelectorAll('a.drill').forEach(a => {
  a.addEventListener('click', (e) => {
    e.preventDefault();
    const type = a.dataset.filterType;
    const director = a.dataset.director || "";
    const store = a.dataset.store || "";
    let rows = detailData;

    // NormalizaÃ§Ã£o para comparar textos (acentos, espaÃ§os, abreviaÃ§Ãµes)
    const norm = (v) => String(v ?? "").toLowerCase().trim()
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
      .replace(/\bsto\.?\b/g,'santo')
      .replace(/\s+/g,' ');

    if (type === "agency") {
      openModal("Detalhe â€” AgÃªncia", "Todas as VEN\'s", rows);
      return;
    }
    if (type === "director") {
      rows = rows.filter(r => norm(r["GestÃ£o"]) === norm(director));
      openModal("Detalhe â€” Diretor", director, rows);
      return;
    }
    if (type === "store") {
      const storeKey = norm(store);
      rows = rows.filter(r => {
        const k1 = norm(r["Loja.1"] ?? "");
        const k2 = norm(r["Loja"] ?? "");
        return (k1 && k1 === storeKey) || (k2 && k2 === storeKey);
      });
      if (director && director !== "__AGENCIA__") {
        rows = rows.filter(r => norm(r["GestÃ£o"]) === norm(director));
        openModal("Detalhe â€” Loja (Diretor)", `${director} â€¢ ${store}`, rows);
      } else {
        openModal("Detalhe â€” Loja", store, rows);
      }
      return;
    }
  });
});
</script>

</body></html>
